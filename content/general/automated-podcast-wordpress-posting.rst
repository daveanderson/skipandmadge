Automated Podcast WordPress Posting
###################################
:date: 2005-07-08 13:08
:category: General

(\**Version 1.0?Ç¬?*

*Copyright David Anderson*

*July 8, 2005*

\*)

**property** timeout\_value : 60

**property** crlf : ";" --*(ASCII character 10) --& (ASCII character
13)*

**property** the\_type : "audio/mpeg"

**property** theWPPostURL :
"http://www.domainname.com/wp-admin/post.php"

**property** podcastDirectoryURL : "http://www.domainname.com/podcasts/"

**set** theProperties **to** fileProperties()

**set** enclosureValue **to** item 1 **of** theProperties

**set** enclosureDate **to** item 2 **of** theProperties

**set** enclosureName **to** item 3 **of** theProperties

--*display dialog enclosureValue & " " & enclosureDate & " " &
enclosureName*

**if** enclosureValue **is not** **equal to** "" **then**

?Ç¬? ?Ç¬? makeWPPost(enclosureValue, enclosureDate, enclosureName)

**else**

?Ç¬? ?Ç¬? display dialog "No file with lable < 4 was found."

**end** **if**

**on** makeWPPost(theValue, theDate, theName)

?Ç¬? ?Ç¬? **set** theUrl **to** "<a href=&#34;" & podcastDirectoryURL &
theName & "&#34;>Podcast of " & item 1 **of** explode(theName, "\_") & "
recorded " & theDate & "</a>"

?Ç¬? ?Ç¬? --*display dialog theUrl*

?Ç¬? ?Ç¬? **tell** application "Safari"

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? activate

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **try**

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? make new document at **the** **beginning**
**of** documents

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **set** **the** URL **of** **the**
**front** document **to** theWPPostURL

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? delay 2

?Ç¬??Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬?

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **if** **my** page\_loaded(timeout\_value)
**is** false **then** **error** "The page did not load in the indicated
timeout value."

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? do JavaScript
"document.forms[0].elements[3].value = \\"" & item 1 **of** **my**
explode(theName, "\_") & " " & theDate & "\\"" in document 1

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? do JavaScript
"document.forms[0].elements[11].value = \\"" & theUrl & "\\"" in
document 1

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? (\**Set the enclosure key and value*\*)

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? do JavaScript
"document.forms[0].elements[32].value = \\"enclosure\\"" in document 1

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? do JavaScript
"document.forms[0].elements[33].value = \\"" & podcastDirectoryURL &
theValue & "\\"" in document 1

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? (\**Toggle check boxes*\*)

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? --*do JavaScript
"document.forms[0].elements[7].click()" in document 1 (\* ALLOW COMMENTS
\*)*

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? --*do JavaScript
"document.forms[0].elements[8].click()" in document 1?Ç¬? (\* ALLOW
PINGS \*)*

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? do JavaScript
"document.forms[0].elements[4].click()" in document 1 (\**CATEGORY 1*\*)

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? do JavaScript
"document.forms[0].elements[5].click()" in document 1 (\**CATEGORY 2*\*)

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? do JavaScript
"document.forms[0].elements[16].click()" in document 1 (\**PUBLISH*\*)

?Ç¬??Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬?

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **on** **error** **the** error\_message number
**the** error\_number

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? --*don't display error message if the user
canceled a dialog within the [try] and [on error] lines above*

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **if** **the** error\_number **is**
**not** -128 **then**

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **set** **the** error\_text
**to** "Error: " & **the** error\_number & ". " & **the** error\_message

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? display dialog **the**
error\_text buttons {"Cancel"} default button 1

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **end** **if**

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **end** **try**

?Ç¬? ?Ç¬? **end** **tell**

**end** makeWPPost

**on** page\_loaded(timeout\_value)

?Ç¬? ?Ç¬? **repeat** **with** i **from** 1 **to** **the** timeout\_value

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **tell** application "Safari"

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **if** (do JavaScript
"document.readyState" in document 1) **is** "complete" **then**

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **return** true

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **else** **if** i **is** **the**
timeout\_value **then**

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **return** false

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **else**

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? delay 1

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **end** **if**

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **end** **tell**

?Ç¬? ?Ç¬? **end** **repeat**

?Ç¬? ?Ç¬? **return** false

**end** page\_loaded

**on** fileProperties()

?Ç¬? ?Ç¬? **tell** application "Finder"

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **set** **the** source\_folder **to** **the** path
to sites folder

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **set** podcastFolder **to** **the** folder
"podcasts" **of** source\_folder

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **set** the\_files **to** **the** contents **of**
podcastFolder

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **set** theName **to** ""

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **set** theSize **to** ""

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **set** theProperties **to** ""

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **set** theCreationDate **to** ""

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **repeat** **with** myFile **in** the\_files

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? --*display dialog (the label index of
myFile) as string*

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **if** **the** label index **of** myFile <
4 **then**

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **set** **the** label index
**of** myFile **to** 4

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **set** theName **to** **the**
name **of** myFile

?Ç¬??Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬?

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **set** theSize **to** **the**
size **of** myFile **as** integer

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **set** theProperties **to**
theName & ";" & theSize & ";" & the\_type

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **set** theCreationDate **to**
**the** creation date **of** myFile

?Ç¬??Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬?

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **end** **if**

?Ç¬??Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬?

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **end** **repeat**

?Ç¬? ?Ç¬? **end** **tell**

?Ç¬? ?Ç¬? **try**

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? --*display dialog theProperties*

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **return** {theProperties, theCreationDate, theName}

?Ç¬? ?Ç¬? **on** **error**

?Ç¬? ?Ç¬? ?Ç¬? ?Ç¬? **return** {"", "", ""}

?Ç¬? ?Ç¬? **end** **try**

**end** fileProperties

**on** explode(haystack, needle)

?Ç¬? ?Ç¬? **set** oldDelims **to** text item delimiters

?Ç¬? ?Ç¬? **set** text item delimiters **to** needle

?Ç¬? ?Ç¬? **set** newText **to** text items **of** haystack

?Ç¬? ?Ç¬? **set** text item delimiters **to** oldDelims

?Ç¬? ?Ç¬? **return** newText

**end** explode
